\documentclass[reprint,aps,prb]{revtex4-1}

%% Language and font encodings
\usepackage[english]{babel}
%\usepackage[utf8x]{inputenc}
%\usepackage[T1]{fontenc}

%% Useful packages
\usepackage{graphicx}
\usepackage{amsmath,amsfonts,amssymb,amsthm}
\usepackage{mathtools,braket}
\usepackage{xifthen}

% notation for standard math
\renewcommand{\d}{\partial}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\dd}{{\rm d}}
\renewcommand{\r}{{\bf r}}
\newcommand{\br}{\bar{\bf r}}
\newcommand{\x}{{\bf x}}
\newcommand{\eps}{\epsilon}
\newcommand{\bomega}{\bar\omega}
\newcommand{\bbomega}{\bar{\bomega}}
\newcommand{\ii}{\mathrm{i}}
\newcommand{\intdef}[3]{\int_{#1}^{#2} \dd {#3}}
\newcommand{\intover}[1]{\int_{-\infty}^{+\infty} \dd {#1}}
\newcommand{\sint}{\mathrlap{\displaystyle\int}
\mathrlap{\textstyle\sum}
\phantom{\mathrlap{\displaystyle
\int}\textstyle\sum}}

% notatiotion for equation environments
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{eqnarray}}
\newcommand{\ea}{\end{eqnarray}}
\newcommand{\baa}{\begin{align}}
\newcommand{\eaa}{\end{align}}
\newcommand{\nn}{\notag}
\newcommand{\qq}{\qquad}
\newcommand{\lb}{\label}
\newcommand{\mat}[1]{\begin{pmatrix} #1\end{pmatrix}}

% notation for the operators
\newcommand{\op}[1]{\hat {#1}}
\newcommand{\sop}[1]{\op{\op {#1}}}
\newcommand{\commutator}[2]{\left[ {#1} , {#2} \right]}
\newcommand{\trace}[1]{\mathrm{tr}\left(#1\right)}
\newcommand{\argument}[1]{\ifthenelse{\isempty{#1}{}}{}{(#1)}}
\newcommand{\matop}[1]{\mathbf{#1}}
\newcommand{\optr}[1]{\check #1}
\newcommand{\opskew}[1]{{\op {#1}}_{\perp}}

% notation for the states
\newcommand{\tket}[1]{| \tilde #1 \rangle}
\newcommand{\tbra}[1]{\langle \tilde #1 |}
\newcommand{\brket}[2]{\langle  #1 | #2 \rangle} %standard braket
\newcommand{\tbraket}[2]{\langle \tilde #1 | #2 \rangle}
\newcommand{\ketbra}[2]{| #1 \rangle \langle #2 |}
\newcommand{\tketbra}[2]{| #1 \rangle \langle \tilde #2 |}
\newcommand{\sket}[2]{| #2)^{#1}}
\newcommand{\sbra}[2]{( #2|_{#1}}
\newcommand{\sketor}[2]{| #2]^{#1}}
\newcommand{\sbraor}[2]{[ #2|_{#1}}
\newcommand{\sbraket}[2]{\braket{\op{#1} | \op{#2}}}
\newcommand{\dket}[1]{\Bigl| #1 \Bigr)}
\newcommand{\dbra}[1]{\Bigl(#1 \Bigr|}
\newcommand{\dbraket}[2]{\Bigl(#1 \Bigl| #2 \Bigr)}
\newcommand{\dketor}[1]{\Bigl| #1 \Bigr]}
\newcommand{\dbraor}[1]{\Bigl[#1 \Bigr|}
\newcommand{\hket}[1]{| #1 ]}
\newcommand{\hbra}[1]{[ #1 |}
\newcommand{\hbraket}[2]{[#1 | #2 ]}

% special operators
\newcommand{\dmnot}{\op{\rho}_0}
\newcommand{\dm}{\op{\rho}}
\newcommand{\hnot}{\op{H}_0}
\newcommand{\hone}[1]{\op{H}_1\argument{#1}}
\newcommand{\transition}[1]{\op T_{#1}}
\newcommand{\excite}[2]{\op e_{{#1}{#2}}}
\newcommand{\decay}[2]{\op d_{{#1}{#2}}}
\newcommand{\Liouv}{\sop{\mathcal L}}
\newcommand{\Liouvnot}{\sop{\mathcal L_0}}
\newcommand{\coupl}{\sop{\mathcal K}}
\newcommand{\honetmp}[1][]{\op{H_1}\argument{#1}} 
\newcommand{\identity}{\op{\mathbb I}}
\newcommand{\rmat}[1]{\optr R}


\begin{document}

%\preprint{APS/123-QED}

\title{On the analytic structure of the linear response susceptibility in open systems}

\author{Luigi Genovese}
\affiliation{Laboratoire de Simulation Atomistique (LSim), SP2M, INAC, CEA-UJF, 17 Av. des Martyrs,
38054 Grenoble, France}
\author{Marco D'Alessandro}%
\affiliation{Istituto di Struttura della Materia-CNR (ISM-CNR), Via del Fosso del Cavaliere 100, 00133 Roma, Italia}

\date{\today}

\begin{abstract}
We analyze how the fundamental equations which govern the linear response properties of a quantum system are influenced by the presence of open boundaries.
In particular we focus our attention on linear-response (LR)-TDDFT calculation of molecular systems. We show that optical excitations of energy below the LR ionization potential 
behave as observable, localized quantities, that can be computationally calculated with high precision, provided an adequate level of completeness.
Above this energy threshold, the analytic structure of the susceptibility functional might be separated in two sectors: one can still be described in terms of observable excitation 
with discrete energies, that can be captured within computational setups tailored for localized states. However such excitations are embedded in a continuum of excited states 
that, on the contrary, behave as plane waves and cannot be described efficiently by the same computational techniques. Such excitations do not exhibit observable features and 
\emph{cannot} be considered as poles of the dynamical polarizability. Nonetheless, the contribution of such continuum of excitation reveals to be of paramount importance even 
for expressing LR quantities in the infrared regime like for example static polarizability.
This is particularly evident for small molecules; we show how these considerations might be influenced by the size of molecular system.
We then present indicators that can help to quantify such potential observable property of an excitation, that can be evaluated 
in any discretization scheme.  This result is a inherent behavior of the system's Liouvillian, and does not depend on computational treatment of the 
unoccupied subspace.
\end{abstract}

%\pacs{Valid PACS appear here}
\maketitle

\section{Introduction}

The subject of the present investigation concerns with the study of isolated molecular-like systems subjected to a time-dependent perturbation in the linear response regime.

The ground state properties of these systems are described within the standard DFT approach in which (valence) electrons are distributed on the Kohn-Sham orbitals. The stability of
the ground state and the localized nature of the system ensures that the KS description of occupied states is represented by a discrete set of wave functions that becomes arbitrary 
small far apart from a compact region around the system's atoms. This behavior indicates that a (finite) basis set will provide a reliable description of the ground state properties 
if it is able to sample a computational domain which contains the natural sizes of the occupied orbitals\cite{boffi2016}. %Results discussed in \cite{boffi2016} confirm this statement. 

The same arguments cannot be rigidly extended to the case in which an external time-dependent field starts acting on the system. Indeed, the perturbation drives the system out 
from the equilibrium and the electrons sample a wider region of the state space, that will contains orbitals of both negative (bound) and positive (unbound) energies. Unbound orbitals 
form a continuum of states in the true system with open boundaries, and the introduction of a finite computational domain has the effects of introducing a fictitious level discretization
\cite{boffi2016}.   

%In this case the relevant physical quantities are the perturbation-induced
%modification of the expectation values of the observable.  one is not dealing with a ground state property and 


The perturbation induces a modification on the ground state density and, choosing the
eigenstates of the unperturbed KS Hamiltonian as a natural basis, one has to include also the virtual (unoccupied) states to described the perturbed density. Virtual states of
positive energy constitute a continuum...

Sebbene non ci sia necessità di usare gli autostati di KS per campionare lo spazio ortogonale a quello in cui si esprime la densità imperturbata, questo argomento solleva un potenziale
problema: quale è la scelta di una basis set idonea per costruire la risposta lineare in modo affidabile?

%a natural criterion for the choice of 




%This fact indicates that a computation basis that is able to sample a finite domain around the molecule will provide an unbiased estimate of ground states properties 


%This fact has also important consequences when one analyzes the effects of a finite computational domain on the reliable evaluation of the system's properties. 


\vspace{1cm}

State something about the assessment of physical reliability for a ground state calculation. Some comment on the setup independence of the results. Introduce the correspondence
between localization properties and observable behavior or physicality. State the, at the present days, similar consideration for the results of linear response are still 
missing...

The basic motivation at the basis of the analysis discussed in this paper is to address to following question: which are the requirement that a computational setup has to
satisfy in order to be able to provide physical results for a linear response calculation? Here with physical we meant that they depend only on the features of the system under
inspection and on the perturbation acting on it. Physical results are unaffected by computational parameters, like the dimension of the computational domain or the nature of
the basis set used to perform the calculations. 

To answer to this question we investigate the properties of the susceptibility, which represents the fundamental object in the contest of linear response. 


\section{Theory}

Linear response can be effectively applied to the analysis of the electronic excitations in molecular and condensed-matter systems. In this framework one consider a system 
described by the Hamiltonian $\hnot$ and assume that the ground-state density $\dmnot$ has been provided. Linear response formalism allows us to evaluate the modification 
of the expectation value of a generic observable induced by a time-dependent perturbing field acting on the system. This quantity, written in the frequency domain, can be expressed 
through the evaluation of the \emph{linear response functional}:
\be\lb{LinearResponseFunctDef1}
\braket{\delta\op O}(\omega) = \trace{\dm'(\omega)\op O} \;,
\ee
where the operator $\op O$ represents the observable\footnote{For a sake of concreteness, we are limiting our considerations to observables that do not explicitly depend on time} 
under inspection. The modification of the ground-state density induced by the perturbation is expressed by the \emph{response density operator} $\dm'(\omega)$ that, in the linear 
response regime, is a linear function of the perturbing field $\op\Phi(\omega)$. For this reason it is possible to define the \emph{susceptibility} superoperator, as follows:
\be\lb{SusceptibilityDef1}
\dm'(\omega) = \sop{{\cal R}}(\omega) \op\Phi(\omega) \;. 
\ee
Susceptibility describes an intrinsic feature of the unperturbed system and determines its response to \emph{any} perturbations, in the linear response regime.

The analysis presented in this section is devoted to a critical review of the fundamental equations which define the response density operator in the linear response regime.    
The aim of this process is to....

%the construction of two different representations of the response density operator... 

\subsection{Fluctuation states. A (de-)localization argument for the response density}

The response density operator is expressed as the first-order variation of ground state density $\sum_{\{p\}} \ket{\psi_p} \bra{\psi_p}$, where the set $\{\ket{\psi_p}\}$ denote the 
occupied states, \emph{i.e} the subset of the bound eigenstates of $\hnot$ with energy $\eps_p$ lower than the Fermi level. Using this notation we denote the energy of the HOMO level 
as $\eps_h$ and identify the value of the first ionization potential with $|\eps_h|$. In what follows we will assume that the set of states $\{\ket{\psi_p}\}$ are real functions, when 
projected in the $\r$-representation.  

By considering the linear order time evolution of the eigenstates of $\hnot$ in presence of the perturbation we can derive the equation of motion of the response density in the form of 
a quantum Liouville equation (for example see \cite{baroni2008}). This procedure suggests us to introduce an explicit representation of the response density in terms of a set of 
$\omega$-dependent \emph{fluctuation states} $\{\ket{f_p(\omega)}\}$, as follows: 
\be\lb{rhoPrimeFluctuationStateDef1}
\dm'(\omega) = \sum_p\left(\ketbra{\psi_p}{f_p(-\omega)} + \ketbra{f_p(\omega)}{\psi_p}\right) \;.
\ee
Fluctuation states are, by construction, orthogonal to the occupied eigenstates of $\hnot$. Moreover, an analysis of the Liouville equation for the response density written in this 
fashion evidences that their equations of motion are written in the form of a modified Sternheimer equation \cite{mahan1980}:
\be\lb{fluctuationStateEqMotion1}
\left[\omega - (\hnot-\eps_p)\right]\ket{f_p(\omega)} = \op Q_0(\op\Phi(\omega)+\op V'(\omega))\ket{\psi_p} \;,
\ee
where $\op Q_0=\identity-\dmnot$ is the projector in the subspace orthogonal to the occupied states of $\hnot$ and the operator $\op V'(\omega)$ is a perturbing term due to the 
density-dependence of the unperturbed Hamiltonian.

The interesting aspect of equations \eqref{fluctuationStateEqMotion1} in the perspective of the present analysis is that they allow us to present a \emph{localization argument} 
for the fluctuation states. To clarify this statement we split the unperturbed Hamiltonian as the sum of the kinetic $\op T$ and potential $\op V$ term and solve \eqref{fluctuationStateEqMotion1} 
in the form of a self-consistent inhomogeneous Helmholtz equation by writing:
\be
\ket{f_p(\omega)} = \op G_H(\omega+\epsilon_p)\ket{s(\omega)} \;,
\ee
where we have introduced the Green function of the Helmholtz operator $\op G_H(\omega) = (\omega-\op T)^{-1}$, % with $k^2_p(\omega) = (\omega+\eps_p)$,
and the \emph{source term} is given by:
\be
\ket{s(\omega)} =  \op V\ket{f_p(\omega)} + \op Q_0(\op V'(\omega) + \op \Phi(\omega))\ket{\psi_p} \;.\nn
\ee
For open boundary conditions in three dimensions, the kernel of $\op G_H(\omega)$ in the coordinate representation reads: 
% \be\lb{HelmholtzKernelDef1}
% \bra{\r}\op G_H(\omega)\ket{\r'} = \frac{1}{4\pi} \left\{ 
% \begin{matrix}
% \frac{e^{-2k_p(\omega)|\r-\r'|}}{|\r-\r'|} \;,\; {\textrm for} \; \omega \leq |\eps_p| \\ 
% \frac{e^{\ii k_p(\omega)|\r-\r'|}}{|\r-\r'|} \;,\; {\textrm for} \; \omega > |\eps_p|
% \end{matrix}
% \right. \;,
% \ee
\be\lb{HelmholtzKernelDef1}
\bra{\r} \op G_H(\omega) \ket{\r'} = \frac{1}{4\pi} \begin{cases}
\frac{e^{2k|\r - \r' |}}{|\r- \r' |} \;,\; & {\textrm for}\; k^2 = \omega  < 0\; \\ 
\frac{e^{2\ii k |\r-\r' |}}{|\r-\r' |} \;, & {\textrm for} \; k^2 = \omega > 0
\end{cases} \;,
\ee
and the $\r$-representation of the fluctuation states $f_p(\omega,\r)$ is expressed through a convolution integral between the kernel \eqref{HelmholtzKernelDef1} and
$\brket{\r'}{s(\omega)}$.
An inspection of the structure of \eqref{HelmholtzKernelDef1} evidences that, for each value of $p$, there exist a threshold value $\omega = |\eps_p|$, 
which govern the localization properties of the corresponding fluctuation state. Indeed, for $\omega > |\eps_p|$,  $\op G_H(\omega)$ behaves as a spherical wave and its
convolution with the source term always give raises to a $f_p(\omega,\r)$ delocalized in the whole accessible space. On the contrary, for values of $\omega$ below the threshold,
the kernel contains an exponential damping factor and $f_p(\omega,\r)$ exhibit a bound-state behavior in the long range.   

% \vspace{0.3cm}
% \noindent{TODO: Add comment to support the localization below threshold}. Two possible way. First way, use the fact that the $\ket{f_p(0)}$ is the nothing but the $p$-\emph{th} 
% eigenstate of the perturbed Hamiltonian with perturbing field $\op\Phi(0)$. The localization of $\ket{f_p(0)}$ can be explicitly checked by solving the ground-state problem for
% this Hamiltonian. How to extended to finite values of $\omega$ below threshold? Second way. Try and iterative solution of the self-consistent Helmholtz equation (below threshold) 
% starting from a localized guess for the fluctuation state. Then state something about the the fact that is reasonable to believe that (for a proper choice of the perturbing field)
% the operators appearing in the source term keep its support compact. If we are able to state this in a appropriate way the localization argument below threshold hold. In my opinion
% this way is better.
% \vspace{0.3cm}

% The knowledge of the long range behavior of the fluctuation states allows us to perform an assessment on the reliability of the evaluation of the linear response functional 
% \eqref{LinearResponseFunctDef1}. To elaborate this statement we make usage of the fluctuation states representation of the response density \eqref{rhoPrimeFluctuationStateDef1}, 
% so that:
% The knowledge of the long range behavior of the fluctuation states allows us to assess the spatial localization properties of the basic objects relevant in the contest of the 
% linear response. In particular, making usage of the fluctuation states representation of the response density \eqref{rhoPrimeFluctuationStateDef1}, we can express the linear 
% response functional \eqref{LinearResponseFunctDef1} as follows: 
% This analysis indicates that the task of providing a reliable assessment of the linear response functional present a different level of complexity   .
% Using the representation of the response density \eqref{rhoPrimeFluctuationStateDef1}, we can express the linear response functional as
% \be\lb{LinearResponseFunctDef2}
% \braket{\delta\op O}(\omega) = 2\sum_p \bra{\psi_p}\op O\ket{f_p(\omega)} \;.
% \ee
This argument can be easily extended to the linear response functional and allows us to determine the spatial localization features of the building blocks relevant for the linear response.  
Indeed, the fluctuation states representation of the response density \eqref{rhoPrimeFluctuationStateDef1} implies that
\be\lb{LinearResponseFunctDef2}
\braket{\delta\op O}(\omega) = 2\sum_p \bra{\psi_p}\op O\ket{f_p(\omega)} \;.
\ee
An inspection of \eqref{LinearResponseFunctDef2} evidences that we can identify two different regimes, on the basis of the value of $\omega$. The first one, which we will refer to as the
\emph{below threshold regime}, is realized for $\omega<|\eps_h|$. In this case the linear response functional is expressed in terms of genuinely localized quantities\footnote{This consideration 
holds for the class of observables for which $\bra{\psi_p}\op O$ is a localized state  with bound-state behavior in the long range}, each of which possesses a physical cut-off radius. 
Due to this behavior, the computational effort needed to provide a reliable evaluation of \eqref{LinearResponseFunctDef2} is determined by the capability of the chosen computational setup to 
express bound-state like wave functions, in a analogous fashion of a ground state calculation. 

On the contrary, the evaluation of the linear response functional can be much more demanding in the \emph{above threshold regime}, realized for $\omega>|\eps_h|$, in which fluctuation 
states start behaving as unbound wave functions. In this case a computational description of fluctuation states is only meaningful in weak sense, \emph{i.e} inside the scalar products of 
\eqref{LinearResponseFunctDef2}, where the bound state character of $\{\bra{\psi_p}\op O\}$ behave as a regulator. This observation indicates that, above threshold, a computational setup 
provides a reliable assessment of \eqref{LinearResponseFunctDef2} only if it is able to express an unbiased description of the fluctuation states in the support of $\{\bra{\psi_p}\op O\}$. 

As an explicit example in support of these arguments we compare the absorption spectrum of a benzene molecule computed in three distinct real-space basis set, which differs for the 
dimension of the computational domain. Results evidences that the curves are almost coincident in the below threshold regime, whereas the effect of the computational setup are clearly
visible in the for values of $\omega$ that exceed the threshold value. 

% This fact implies that a computational setup has different chances of providing a reliable assessment of the linear response functional \eqref{LinearResponseFunctDef2} depending
% to the value of $\omega$. 
% This observation has relevant consequence on the capability of a computational setup to provide a reliable assessment of the linear response functional....  

\vspace{0.3cm}
\noindent{TODO: Numerical example (convergence below threshold of the Benzene spectrum computed in different computational setup).}
\vspace{0.3cm}

%This analysis, carried out starting from the representation of the linear response functional in terms of fluctuation states, evidences some general properties of the linear response. 
%In the next sections we will reformulate an analogous procedure directly looking at the susceptibility. This analysis lead us to the core of the paper, namely the description of the
%analytical structure of the linear response susceptibility. 

\subsection{Excitation operators. A spectral decomposition representation for the response density}

The analysis carried out starting from the representation of the linear response functional in terms of fluctuation states has evidenced some general properties of the linear response
for open systems. In particular, by analyzing the asymptotic behavior of fluctuation states in long range limit, we have showed that they exhibit a bound-state character in the regime  
$\omega<|\eps_h|$. Consequently we have argued that the linear response functional, in the same $\omega$ range, provides a setup-independent result with a modest computational effort. 

Now we reformulate an analogous analysis looking at the susceptibility superoperator, implicit defined through \eqref{SusceptibilityDef1}. This approach leads to the concept of \emph{excitation 
operators}, defined through a self-consistent operator eigenvalue equation. Excitations behave as singularity of the susceptibility operator and their knowledge provides a deeper insight 
into the analytic structure of the linear response. 

The starting point of this analysis is represented by the Liouville equation for the response density operator:
\be\lb{LiouvillianRhopomegaDef1}
\left(\omega - \Liouv\right) \dm'(\omega) =  \commutator{\op\Phi(\omega)}{\dmnot} \;.
\ee
Using the spectral decomposition of the resolvent of the Liouvillian we have:
\be\lb{RhopExcitationDef1}
\sop{{\cal R}}(\omega) \cdot   =
\sint\dd E \, \op E
\frac{\trace{\opskew{\tilde E}\cdot}}{\omega-E} \;,
\ee
with $\opskew{O} = \commutator{\op O}{\dmnot}$. 
Excitation operators as eigenstates of the Liouvillian (keep left and right different or not?):
\be\lb{ExcitationOperatorsDef1}
\Liouv \op E = E \op E \;, \qq
 \op{\tilde E} \Liouv = E \op{\tilde E}
\ee
We can express excitation operators as follows:
\begin{align}\lb{ExcitationOperatorsDef2}
\op E &= \sum_p \left( \ket{\phi^E_p}\bra{\psi_p} + \ket{\psi_p} \bra{\chi^E_p}\right)\;, \nn \\
\op {\tilde E} &= \sum_p \left( \ket{\psi_p} \tbra{\phi^E_p} + \tket{\chi^E_p}\bra{\psi_p} \right)\;.
\end{align}


\subsection{Comments. The analytic structure of the linear response susceptibility}

...........



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% In the framework of the linear response formalism one is typically interested in computing the \emph{linear response functional}:
% \be\lb{LinearResponseFunctDef1}
% {\cal R}_{\op O}(\omega) = \trace{\dm'(\omega)\op O} \;,
% \ee
% that represents the perturbation-induced modification of the expectation value of an observable $\op O$\footnote{For a sake of concreteness, we are limiting our considerations 
% to observables that do not explicitly depend on time}. Here $\dm'(\omega)$ is the \emph{response density operator} that describes the $\omega$-dependent modification of the density 
% operator induced by the perturbation.
% 
% \subsection{Basic equations for the linear response formalism for electronic excitations}
% 
% The linear response formalism can be effectively applied to the analysis of the electronic excitations of molecular and condensed-matter systems, described by the (density-dependent) 
% ground-state hermitian Hamiltonian $\hnot$, coupled to an external perturbation described by the perturbing field $\op\Phi(\omega)$. The $\omega$ structure of $\op\Phi(\omega)$ codifies both 
% the intrinsic time dependence of the perturbation and the switching-on procedure, \emph{e.g.} adiabatic or sudden limit protocols. 
% 
% The response density is expressed as the first-order variation of ground state density
% \be\label{rhodef1}
% \dmnot = \sum_{\{p\}} \ket{\psi_p} \bra{\psi_p}  \;,
% \ee
% where $\{\psi_p\}$ denote the occupied states, \emph{i.e} the subset of the bound eigenstates of $\hnot$ with energy lower than the Fermi level.
% By considering the linear order time evolution of these states in presence of the perturbation we can express the response density in the $\omega$ domain as follows:
% \be\lb{rhoPrimeOmegaDef1}
% \dm'(\omega) = \ii \commutator{\dmnot}{\op A(\omega)} \;,
% \ee
% where $\op A(\omega)$ is a sum of two terms, both written as a triple convolution with the retarded/advanced Green functions $\op G_0^{\pm}$ of the unperturbed Hamiltonian:
% \be
% \op A(\omega) = \frac{1}{2\pi} \int_{-\infty}^\infty  \dd \omega'
% \op G_0^+(\omega') \left(\op \Phi(\omega)+\op V'(\omega)\right) \op G_0^-(\omega'-\omega)\;. \nn
% \ee
% The presence of the second addend is due to the density dependence of the unperturbed Hamiltonian and describes the perturbation induced by the variation of $\hnot$ under the
% action of the perturbing field. In the linear response regime this quantity can be expressed as the functional derivatives of $\hnot$ with respect to the density kernel 
% (evaluated at $\dm=\dmnot$) times the value of the induced density modification, that is:
% \be\label{VpDef1}
% \op V'(\omega)= 
% \int \dd \r \dd \r' \frac{\delta\hnot}{\delta \rho_0(\r,\r')}
% \trace{\dm'(\omega) \ket{\r} \bra{\r'}} \;.
% \ee
% 
% \subsection{Fluctuation states. A localization argument for the linear response functional}
% 
% We start this analysis by deriving an ulterior expression of the response density operator in the frequency space. We consider equation \eqref{rhoPrimeOmegaDef1} and observe that, for any 
% operator $\op O$, we may write:  
% \be
% \commutator{\dmnot}{\op O} = \dmnot \op O \op Q_0 - \op Q_0 \op O \dmnot\;,
% \ee
% where $\op Q_0= \identity - \dmnot$ is the projection operator in the subspace orthogonal to $\dmnot$. So, thanks to this relation we have that:
% \be
% \dm'(\omega) = \ii\sum_p\left(\ketbra{\psi_p}{\psi_p}\op A(\omega)\op Q_0 - \op Q_0\op A(\omega)\ketbra{\psi_p}{\psi_p}\right) \;.
% \ee
% This equation suggests us to define the \emph{fluctuation states}:
% \be\lb{fluctuationStateDef1}
% \ket{f_p(\omega)} \doteq -\ii\op Q_0\op A(\omega)\ket{\psi_p} \;, \quad
% \bra{f_p(\omega)} \doteq \bra{\psi_p}\ii\op A(-\omega)\op Q_0 \;,
% \ee
% where the $\omega$ dependence of the bra is consistent with hermitian conjugation property of the Fourier transform of a hermitian operator. Fluctuation states are, by 
% definition, orthogonal to the occupied eigenstates of $\hnot$, so that:
% \be
% \brket{f_p(\omega)}{\psi_q} = \brket{\psi_q}{f_p(\omega)} = 0 \;, \forall \, p,q,\omega \;.
% \ee
% The response density written in terms of the fluctuation states reads:
% \be\lb{rhoPrimeFluctuationStateDef1}
% \dm'(\omega) = \sum_p\left(\ketbra{\psi_p}{f_p(-\omega)} + \ketbra{f_p(\omega)}{\psi_p}\right) \;,
% \ee
% and consequently the linear response functional can be expressed as:
% \be\lb{LinearResponseFunctDef2}
% {\cal R}_{\op O}(\omega) = 
% \sum_p\left(\bra{f_p(-\omega)}\op O\ket{\psi_p} + \bra{\psi_p}\op O\ket{f_p(\omega)}\right) \;.
% \ee


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\bibliography{Analytic_biblio}

\end{document}
